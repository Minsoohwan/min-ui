import{j as n}from"./jsx-runtime-BjG_zV1W.js";import{R as r}from"./index-DpTt3J-R.js";import{r as K}from"./index-D9ZhQrDp.js";import{V as P}from"./ValidationMessages-DkT8DR7l.js";import{C as B}from"./CheckBox-XtxcCkuZ.js";const M=r.forwardRef(({items:S,value:h=null,multiple:d=!1,validationMessages:g=[],onChange:a,visible:$=!0,width:R,height:A,onInitialized:N,disabled:m=!1,style:D,className:H="",usePortal:i=!0,...Q},b)=>{var q;const p=r.useMemo(()=>Array.isArray(S)?S.map(e=>typeof e=="object"&&e!==null?e:{value:e,display:String(e)}):[],[S]),j=r.useCallback(e=>{if(/^-?\d+(\.\d+)?$/.test(e)){const t=Number(e);return Number.isNaN(t)?e:t}return e},[]),E=r.useCallback(e=>d?Array.isArray(e)?e.map(t=>t==null?"":String(t)):[]:e==null?"":String(e),[d]),[o,y]=r.useState(()=>E(h));r.useEffect(()=>{y(E(h))},[h,E]);const L=r.useRef(null),I=e=>{L.current=e,typeof b=="function"?b(e):b&&(b.current=e)};if(r.useEffect(()=>{N==null||N(L.current)},[]),!$)return null;const O=e=>{const t=Array.isArray(o)?[...o]:[],s=t.indexOf(e);s>=0?t.splice(s,1):t.push(e),y(t);const u=t.map(v=>j(String(v)));a==null||a(u)},[l,f]=r.useState(!1),x=r.useRef(null),V=r.useRef(null),[C,_]=r.useState({}),c=r.useCallback(()=>{if(!x.current)return;const e=x.current.getBoundingClientRect();_({position:"fixed",left:e.left,top:e.bottom+4,width:e.width,zIndex:1e3})},[]);r.useEffect(()=>{function e(t){const s=t.target,u=x.current,v=V.current,G=!!(u&&u.contains(s)),J=!!(v&&v.contains(s));!G&&!J&&f(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),r.useLayoutEffect(()=>{l&&i&&c()},[l,i,c]),r.useEffect(()=>{if(!l||!i)return;c();const e=()=>c(),t=()=>c();return window.addEventListener("scroll",e,!0),window.addEventListener("resize",t),()=>{window.removeEventListener("scroll",e,!0),window.removeEventListener("resize",t)}},[l,i,c]);const T={...D,...R!=null?{width:R}:{},...A!=null?{height:A}:{}},z=Array.isArray(g)&&g.length>0,F=r.useMemo(()=>{if(!d)return"";const e=Array.isArray(o)?o:[];if(e.length===0)return"None";const t=p.filter(s=>e.indexOf(String(s.value))>=0).map(s=>s.display);return t.length>0?t.join(", "):`${e.length} selected`},[o,d,p]),w=d?n.jsx("div",{role:"listbox","aria-multiselectable":!0,className:"min-ui-selectbox-dropdown",children:p.map((e,t)=>{if(e.visible===!1)return null;const s=String(e.value),u=Array.isArray(o)&&o.indexOf(s)>=0;return n.jsx("div",{className:`min-ui-selectbox-item ${e.disabled||m?"min-ui-selectbox-item-disabled":""}`,children:n.jsx(B,{checked:u,disabled:m||e.disabled,onChange:()=>O(s),label:e.display,width:"auto",className:"min-ui-selectbox-checkbox"})},t)})}):n.jsx("div",{role:"listbox",className:"min-ui-selectbox-dropdown",children:p.map((e,t)=>{if(e.visible===!1)return null;const s=String(e.value),u=String(o)===s;return n.jsx("div",{className:`min-ui-selectbox-item ${e.disabled||m?"min-ui-selectbox-item-disabled":""}`,onClick:()=>{!e.disabled&&!m&&(y(s),a==null||a(s===""?null:j(s)),f(!1))},children:d?n.jsx(B,{checked:u,disabled:m||e.disabled,onChange:()=>{y(s),a==null||a(s===""?null:j(s)),f(!1)},label:e.display,width:"auto",className:"min-ui-selectbox-checkbox"}):n.jsx("span",{className:"min-ui-selectbox-item-label",children:e.display})},t)})}),k=l?i?K.createPortal(n.jsx("div",{ref:V,className:"min-ui-selectbox-portal",style:C,children:w}),document.body):w:null;return n.jsxs("div",{ref:I,style:T,className:`min-ui-selectbox-wrapper ${H} min-ui-selectbox-container`,children:[d?n.jsxs("div",{ref:x,className:"min-ui-selectbox-dropdown-container",style:{height:T.height},children:[n.jsxs("button",{type:"button",onClick:()=>f(e=>{const t=!e;return t&&i&&c(),t}),disabled:m,className:"min-ui-selectbox-button","aria-haspopup":"listbox","aria-expanded":l,children:[n.jsx("span",{className:"min-ui-selectbox-text",children:F}),n.jsx("span",{className:`min-ui-selectbox-arrow ${l?"min-ui-selectbox-arrow-open":""}`})]}),l&&(i?k:w)]}):n.jsxs("div",{ref:x,className:"min-ui-selectbox-dropdown-container",style:{height:T.height},children:[n.jsxs("button",{type:"button",onClick:()=>f(e=>{const t=!e;return t&&i&&c(),t}),disabled:m,className:"min-ui-selectbox-button","aria-haspopup":"listbox","aria-expanded":l,children:[n.jsx("span",{className:"min-ui-selectbox-text",children:((q=p.find(e=>String(e.value)===String(o)))==null?void 0:q.display)||"--"}),n.jsx("span",{className:`min-ui-selectbox-arrow ${l?"min-ui-selectbox-arrow-open":""}`})]}),l&&(i?k:w)]}),n.jsx(P,{visible:z,messages:g})]})});M.displayName="SelectBox";M.__docgenInfo={description:"",methods:[],displayName:"SelectBox",props:{items:{required:!0,tsType:{name:"union",raw:"SelectBoxItem[] | (string | number)[]",elements:[{name:"Array",elements:[{name:"SelectBoxItem"}],raw:"SelectBoxItem[]"},{name:"Array",elements:[{name:"unknown"}],raw:"(string | number)[]"}]},description:""},value:{required:!1,tsType:{name:"any"},description:"",defaultValue:{value:"null",computed:!1}},multiple:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},validationMessages:{required:!1,tsType:{name:"union",raw:"string[] | null",elements:[{name:"Array",elements:[{name:"string"}],raw:"string[]"},{name:"null"}]},description:"",defaultValue:{value:"[]",computed:!1}},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(value: any) => void",signature:{arguments:[{type:{name:"any"},name:"value"}],return:{name:"void"}}},description:""},visible:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},width:{required:!1,tsType:{name:'ReactCSSProperties["width"]',raw:'React.CSSProperties["width"]'},description:""},height:{required:!1,tsType:{name:'ReactCSSProperties["height"]',raw:'React.CSSProperties["height"]'},description:""},onInitialized:{required:!1,tsType:{name:"signature",type:"function",raw:"(el: HTMLDivElement | HTMLSelectElement | null) => void",signature:{arguments:[{type:{name:"union",raw:"HTMLDivElement | HTMLSelectElement | null",elements:[{name:"HTMLDivElement"},{name:"HTMLSelectElement"},{name:"null"}]},name:"el"}],return:{name:"void"}}},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},usePortal:{required:!1,tsType:{name:"boolean"},description:"드롭다운을 document.body 포털로 렌더링 (overflow 무시). 기본값: true",defaultValue:{value:"true",computed:!1}},className:{defaultValue:{value:'""',computed:!1},required:!1}},composes:["Omit"]};export{M as S};
